## 图解HTTP：HTTP基础

### TCP／IP 分层好处

如果没有分层，当某个地方修改时，就必须把所有部分整体都替换掉。但是分层之后，只需要把变动的层 修改掉就可以了。每个层次的内部可以自由的改动

分层之后设计也变得简单，比如，应用层，就只需要考虑分派自己的任务就可以，不需要关注对方的位置，传输线路的问题，是否可以传输到达的问题。


* 应用层：决定了向用户提供应用服务时通信的活动
	 * `FTP`、`DNS`
* 传输层：两台计算机间的数据传输，进程间通信
	* `TCP`、`UDP`
* 网络层：处理网络上的数据包，端到端
* 链路层：用来处理连接网络的硬件部分
	* 网卡、硬件的设备驱动
	
### IP、TCP、DNS

* IP：网际协议
	* 最主要的是`IP`地址和`MAC`地址
	* IP地址是节点被分配到的地址，可变化、但是MAC地址是网关所属的固定地址，不会发生变化
	* 关于`ARP`与`MAC`地址查询  
* `TCP`：确保数据可到达目标
	* 三次握手
* `DNS`：域名解析
	* 根据习惯，域名使用更符合人类的记忆习惯。
	* `DNS `可以更具域名查找IP地址，也可以从IP地址反查域名

### URL 与 URI

* `URI（Uniform Resource Identifier）`：统一资源标识符
* `URL（Uniform Resource Locator）`：统一资源定位符

### HTTP 是不保存状态的协议

* 协议自身不对请求和响应之间的通信状态进行保存。也就是说，`HTTP`这个级别，对于发送的请求和响应不做持久化处理
* 那么为什么，淘宝这样的网站不同的页面都保持着登录状态呢？是因为`cookie`技术的使用


### 告诉服务器意图的HTTP方法

* `GET`：获取资源
* `POST`：传输实体主体
* `PUT`：传输文件，要求在请求的报文中包含文件内容
* `HEAD`：获取报文头部，与`GET`方法类似，只是不返回报文主体部分。用于确认`URI`的有效性和更新时间等。
* `DELETE`：删除文件，是与`PUT`相反的方法
* `OPTIONS`：询问支持的方法，用来查询针对请求`URI`指定的资源支持的方法
* `TRACE`：让服务器把之前的请求通信环回给客户端的方法。用来确认在连接过程中发生一系列方法。
* `CONNECT`：用隧道协议连接代理，主要是通过`SSL（Secure Sockets Layer）`和`TLS（Transport Layer Secrity ）`协议把传输内容加密后传输

### Cookie状态管理

HTTP是无状态的，不对之前的请求和响应进行管理，这样就减少了服务器的CPU和内存资源的消耗。

为了解决一些需要保存状态的问题，例如，登录状态，引入了`cookie`技术

`Cookie`会根据从服务器发送的响应报文内的一个叫做`set-Cookie`的首部子段信息，通知客户端保存`Cookie`。当下次客户端再次发送请求时，客户端会自动把`cookie`信息加入进去。

服务器收到客户端发来的`Cookie`信息后，会检查是那个客户端发来的，然后对比服务器上的记录，最后返回之前的状态信息。

![](http://7xrn7f.com1.z0.glb.clouddn.com/16-6-4/15148521.jpg)
 
### HTTP请求报文和响应报文的结构

![](http://7xrn7f.com1.z0.glb.clouddn.com/16-6-4/91752355.jpg)

### 编码提升传输效率

`HTTP`报文主要用于传输请求和响应的实体主体

报文主体和实体主体：

* 通常报文主体等于实体主体，只有当传输中进行编码操作时，实体主体的内容就发生了变化，导致两者发生了差异
* 内容编码类似我们电脑中常用的压缩包，内容编码后的实体，由客户端接收并进行解码

在HTTP通信中，请求的资源未全部完成前，浏览器无法显示。在请求大容量数据时，可以把数据进行分割多块，这样浏览器可以逐步显示，这个叫做分块传输编码

